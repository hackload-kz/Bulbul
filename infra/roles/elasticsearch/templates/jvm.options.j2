## JVM configuration for Elasticsearch
## WARNING: DO NOT EDIT THIS FILE. Edit the JVM options in the jvm.options.d directory instead.

################################################################
## Expert settings
################################################################

## GC configuration
8-13:-XX:+UseConcMarkSweepGC
8-13:-XX:CMSInitiatingOccupancyFraction=75
8-13:-XX:+UseCMSInitiatingOccupancyOnly

## G1GC Configuration
# NOTE: G1GC is only supported on JDK version 10 or later.
14-:-XX:+UseG1GC
14-:-XX:G1ReservePercent=25
14-:-XX:InitiatingHeapOccupancyPercent=30

## JVM heap size
## Set the minimum and maximum heap sizes (should be the same value)
-Xms{{ elasticsearch_heap_size }}
-Xmx{{ elasticsearch_heap_size }}

## JVM options for production deployments
-XX:+AlwaysPreTouch
-Xss1m
-Djava.awt.headless=true
-Dfile.encoding=UTF-8
-Djna.nosys=true
-XX:-OmitStackTraceInFastThrow
-Dio.netty.noUnsafe=true
-Dio.netty.noKeySetOptimization=true
-Dio.netty.recycler.maxCapacityPerThread=0
-Dlog4j.shutdownHookEnabled=false
-Dlog4j2.disable.jmx=true

## JVM memory settings
-XX:+HeapDumpOnOutOfMemoryError
-XX:HeapDumpPath={{ elasticsearch_data_path }}
-XX:ErrorFile={{ elasticsearch_logs_path }}/hs_err_pid%p.log

## JVM temporary directory
-Djava.io.tmpdir=${ES_TMPDIR}

## Leverage secure defaults for Java
-Djna.tmpdir=${ES_TMPDIR}
-XX:+DisableExplicitGC

## heap dumps
## generate a heap dump when an allocation from the Java heap fails
## heap dumps are created in the working directory of the JVM
-XX:+HeapDumpOnOutOfMemoryError

## specify an alternative path for heap dumps; ensure the directory exists and
## has sufficient space
-XX:HeapDumpPath={{ elasticsearch_data_path }}

## specify an alternative path for JVM fatal error logs
-XX:ErrorFile={{ elasticsearch_logs_path }}/hs_err_pid%p.log